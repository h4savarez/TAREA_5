---
title: "R Notebook"
output: html_notebook
---



```{r}
library(tidyverse)
questions <- read_csv("questions.csv")
answers <- read_csv("answers.csv")
tags <- read_csv("tags.csv")
question_tags <- read_csv("question_tags.csv")

view(questions)
view(answers)
view(tags)
view(question_tags)
```

   1.1. Relacione questions y question_tags usando las columnas id y question_id, respectivamente
```{r}

questions %>%
  left_join(question_tags, by = c("id" = "question_id"))
```
1.2. Agregue una relación más para la tabla tags.

```{r}

questions %>%
  left_join(question_tags, by = c("id" = "question_id")) %>%
  left_join(tags, by = c("tag_id" = "id"))

```
1.3.  Utilice replace_na para cambiar los NA en la columna tag_name a "only-r".

```{r}
questions %>%
left_join(question_tags, by = c("id" = "question_id")) %>%
left_join(tags, by = c("tag_id" = "id")) %>%
replace_na(list(tag_name = "only-r"))


```
1.4. Por último, almacene el resultado en la variable questions_with_tags.

```{r}
questions_with_tags <- questions %>%
left_join(question_tags, by = c("id" = "question_id")) %>%
left_join(tags, by = c("tag_id" = "id")) %>%
replace_na(list(tag_name = "only-r"))
 
```

2.1.Utilice questions_with_tags y aplique group_by para la variable tag_name.

```{r}
questions_with_tags %>%
group_by(tag_name)

```

2.2. Aplique summarize para obtener el score promedio de cada pregunta y asígnele el nombre mean_score.

```{r}
questions_with_tags %>%
  group_by(tag_id) %>%
  
summarize(mean_score = mean(score))


```
2.3. Ordene mean_score en forma descendente
```{r}
questions_with_tags %>%
group_by(tag_id) %>%
summarize(mean_score = mean(score)) %>%
arrange(desc(mean_score))



```

3.1. Utilice inner_join para combinar las tablas questions y answers, luego aplique los sufijos
"_question" y "_answer", respectivamente.

```{r}

questions %>%
inner_join(answers, by = c("id" = "question_id"), suffix = c("_question", "_answer"))

#view(mat)


```
3.2. Agregue una nueva columna utilizando la función mutate. La nueva columna se llamará
gap y contendrá la resta de creation_date_answer y creation_date_question.
(creation_date_answer - creation_date_question).

```{r}
questions %>%

  inner_join(answers, by = c("id" = "question_id"), suffix = c("_question", "_answer")) %>%
  mutate(gap=creation_date_answer-creation_date_question)

```

4. Joining question and answer counts

4.1. Cuente y ordene la columna question_id en la tabla de answers, luego almacene elresultado en la variable answer_counts

```{r}
answer_counts <- answers %>%
  count(question_id) %>%
  arrange(question_id)
  answer_counts

```

4.2. Relacione la tabla questions con answer_counts (utilice left_join).
```{r}
questions %>%
  left_join(answer_counts, by = c("id" = "question_id"))%>%
arrange(creation_date)

```

4.3. Reemplace los valores NA en la columna n con ceros.

```{r}
questions %>%
  left_join(answer_counts, by = c("id" = "question_id"))%>%
  
replace_na(list(n=0))%>%

```



4.4. Por último almacene el resultado en la variable question_answer_counts

```{r}
question_answer_counts <- questions %>%
 
  left_join(answer_counts, by = c("id" = "question_id"))%>%
  
replace_na(list(n=0))

  question_answer_counts
```
5. Joining questions, answers, and tags
Identifiquemos qué temas de R generan más interés en Stack Overflow.
5.1. Combine question_tags con question_answer_counts usando inner_join.
```{r}
question_tags %>%
  inner_join(question_answer_counts, by = c("question_id" = "id"))

```




5.2. Ahora, use otro inner_join para agregar la tabla tags.
```{r}

question_tags %>%
  inner_join(question_answer_counts, by = c("question_id" = "id")) %>%
  inner_join(tags, by = c("tag_id" = "id"))
```

